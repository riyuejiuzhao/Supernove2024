# Supernove2024

2024年腾讯超新星比赛后台项目

## 题目

游戏消息路由 MiniGameRouter 设计

## 题目调研

SDK必备接口：
1. 服务注册，一个服务启动时，将其注册到RouterServer
2. 服务发现，返回Client请求的服务
3. 健康监测
4. 常规路由匹配规则，
5. 定义路由匹配规则，根据相同前缀进行匹配，并且根据路由匹配规则实现路由查找

性能要求：
1. 支持千万级别的路由表
2. 分析SDK性能占用
3. 对路由规则进行压力测试

进阶要求：
1. 结合grpc实现
2. SideCar可以参考Istio实现

## 架构设计

### 基本设计
采用yaml作为配置文件，提供基本配置，将整体服务分为3个微型服务器
1. 服务发现svr
2. 服务注册svr
3. 健康检查svr

### 配置设计
配置文件要指明三个微务器集群的地址

### SDK设计
使用grpc作为与SDK通信的协议

### 服务注册svr设计
服务发现每次增量更新后都需要重新写入redis中

### 服务发现svr设计
采用Redis云服务器作为数据库储存服务数据，
添加本地缓存的数据，主要数据在redis内储存，每过一段时间（可配置）就从redis中同步一次数据

### 健康检查svr设计
这里参照consul，设计两种健康检查
1. TTL，服务自己上报健康数据
2. 服务器主动请求HTTP健康检查，HTTP服务器可以在服务注册的时候指定

### 动态路由svr设计
1. 一致性哈希
2. 随机
3. 基于权重
4. 指定目标
5. 键值对前缀匹配

### 路由策略和动态路由


## 接口设计

